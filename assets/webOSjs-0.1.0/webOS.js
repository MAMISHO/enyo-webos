function LS2Request(e,t){this.uri=e,t=t||{},t.method&&("/"!=this.uri.charAt(this.uri.length-1)&&(this.uri+="/"),this.uri+=t.method),"function"==typeof t.onSuccess&&(this.onSuccess=t.onSuccess),"function"==typeof t.onFailure&&(this.onFailure=t.onFailure),"function"==typeof t.onComplete&&(this.onComplete=t.onComplete),this.params="object"==typeof t.parameters?t.parameters:{},this.subscribe=t.subscribe||!1,this.subscribe&&(this.params.subscribe=t.subscribe),this.params.subscribe&&(this.subscribe=this.params.subscribe),this.resubscribe=t.resubscribe||!1,this.send()}window.webOS=window.webOS||{};try{var deviceInfo=JSON.parse(PalmSystem.deviceInfo);webOS.device=deviceInfo}catch(e){webOS.device={}}if(window.PalmSystem)if(webOS.platform={},navigator.userAgent.indexOf("SmartWatch")>-1)webOS.platform.watch=!0;else if(navigator.userAgent.indexOf("SmartTV")>-1||navigator.userAgent.indexOf("Large Screen")>-1)webOS.platform.tv=!0;else if(webOS.device.platformVersionMajor&&webOS.device.platformVersionMinor)try{var major=parseInt(webOS.device.platformVersionMajor),minor=parseInt(webOS.device.platformVersionMinor);3>major||3==major&&0>=minor?webOS.platform.legacy=!0:webOS.platform.open=!0}catch(e){webOS.platform.open=!0}else webOS.platform.open=!0;webOS.fetchAppId=function(){return window.PalmSystem?PalmSystem.identifier.split(" ")[0]:void 0},webOS.fetchAppInfo=function(){if(!this.appInfo){var e=function(e){if(window.palmGetResource)try{return palmGetResource(e)}catch(t){console.log("error reading appinfo.json"+t.message)}else{var o=new XMLHttpRequest;if(o.open("GET",e+"?palmGetResource=true",!1),o.send(null),o.status>=200&&o.status<300)return o.responseText;console.log("error reading appinfo.json")}},t=this.fetchAppId(),o=[this.fetchAppRootPath()+"appinfo.json","file:///media/cryptofs/apps/usr/palm/applications/"+t+"/appinfo.json","file:///usr/palm/applications/"+t+"/appinfo.json"],n=o[0].indexOf(t);n>-1&&o.unshift(o[0].substring(0,n)+t+"/appinfo.json");for(var a=void 0,r=0;r<o.length&&!a;r++)a=e(o[r]);a&&(this.appInfo=enyo.json.parse(a))}return this.appInfo},webOS.fetchAppRootPath=function(){var e=window.location.href;if("baseURI"in window.document)e=window.document.baseURI;else{var t=window.document.getElementsByTagName("base");t.length>0&&(e=t[0].href)}var o=e.match(new RegExp(".*://[^#]*/"));return o?o[0]:""},webOS.feedback={play:function(e){if(webOS&&webOS.platform&&webOS.platform.watch){var t={name:e||"touch",sink:"pfeedback"};if(!window.PalmServiceBridge)return;webOS.service.request("luna://com.palm.audio/systemsounds",{method:"playFeedback",parameters:t,subscribe:!1,resubscribe:!1})}}};var hasVKeyboard=!(webOS.platform.legacy&&webOS.device.platformVersionMajor&&parseInt(webOS.device.platformVersionMajor)<3);if(hasVKeyboard){var state={};Mojo=window.Mojo||{},Mojo.keyboardShown=function(e){state.isShowing=e},webOS.keyboard={types:{text:0,password:1,search:2,range:3,email:4,number:5,phone:6,url:7,color:8},isShowing:function(){return state.isShowing||!1},show:function(e){this.isManualMode()&&window.PalmSystem&&PalmSystem.keyboardShow(e||0)},hide:function(){this.isManualMode()&&window.PalmSystem&&PalmSystem.keyboardHide()},setManualMode:function(e){state.manual=e,window.PalmSystem&&PalmSystem.setManualKeyboardEnabled(e)},isManualMode:function(){return state.manual||!1},forceShow:function(e){this.setManualMode(!0),window.PalmSystem&&PalmSystem.keyboardShow(e||0)},forceHide:function(){this.setManualMode(!0),window.PalmSystem&&PalmSystem.keyboardHide()}}}if((webOS.platform.legacy||webOS.platform.open)&&!window.cordova){var fireDocumentEvent=function(e,t){var o=document.createEvent("Events");o.initEvent(e,!1,!1);for(var n in t)o[n]=t[n];document.dispatchEvent(o)};Mojo=window.Mojo||{};var lp=JSON.parse(PalmSystem.launchParams||"{}")||{};fireDocumentEvent("webOSLaunch",{type:"webOSLaunch",detail:lp}),window.Mojo.relaunch=function(e){var t=JSON.parse(PalmSystem.launchParams||"{}")||{};return t["palm-command"]&&"open-app-menu"==t["palm-command"]?(fireDocumentEvent("menubutton",{}),!0):void fireDocumentEvent("webOSRelaunch",{type:"webOSRelaunch",detail:t})},window.PalmSystem&&window.PalmSystem.stageReady()}webOS.notification={showToast:function(e,t){var o=e.message||"",n=e.icon||"",a=webOS.fetchAppId(),r=e.appId||a,i=e.params||{},s=e.target,l=e.noaction,c=e.stale||!1,m=e.soundClass||"",u=e.soundFile||"",w=e.soundDurationMs||"";if(webOS.platform.legacy||webOS.platform.open){var d=(e.response||{banner:!0},PalmSystem.addBannerMessage(o,JSON.stringify(i),n,m,u,w));t&&t(d)}else{o.length>60&&console.warn("Toast notification message is longer than recommended. May not display as intended");var p={sourceId:a,message:o,stale:c,noaction:l};n&&n.length>0&&(p.iconUrl=n),l||(p.onclick=s?{target:s}:{appId:r,params:i}),this.showToastRequest=webOS.service.request("palm://com.webos.notification",{method:"createToast",parameters:p,onSuccess:function(e){t&&t(e.toastId)},onFailure:function(e){console.error("Failed to create toast: "+JSON.stringify(e)),t&&t()}})}},removeToast:function(e){if(webOS.platform.legacy||webOS.platform.open)try{PalmSystem.removeBannerMessage(e)}catch(t){console.warn(t),PalmSystem.clearBannerMessage()}else this.removeToastRequest=webOS.service.request("palm://com.webos.notification",{method:"closeToast",parameters:{toastId:e}})},supportsDashboard:function(){return webOS.platform.legacy||webOS.platform.open},showDashboard:function(e,t){if(webOS.platform.legacy||webOS.platform.open){var o=window.open(e,"_blank",'attributes={"window":"dashboard"}');return t&&o.document.write(t),o.PalmSystem&&o.PalmSystem.stageReady(),o}console.warn("Dashboards are not supported on this version of webOS.")}},webOS.orientation={setOrientation:function(e){window.PalmSystem&&PalmSystem.setWindowOrientation&&PalmSystem.setWindowOrientation(e)},getOrientation:function(){return window.PalmSystem&&PalmSystem.setWindowOrientation?PalmSystem.windowOrientation:"up"}};var levelNone=-1,levelEmergency=0,levelAlert=1,levelCritical=2,levelError=3,levelWarning=4,levelNotice=5,levelInfo=6,levelDebug=7,isObject=function(e){return!!e&&"object"==typeof e&&"[object Array]"!==Object.prototype.toString.call(e)},log=function(e,t,o,n){window.PalmSystem&&(o&&!isObject(o)&&(e=levelError,o={msgid:t},t="MISMATCHED_FMT",n=null,console.warn("webOSLog called with invalid format: keyVals must be an object")),t||e==levelDebug||console.warn("webOSLog called with invalid format: messageId was empty"),o&&(o=JSON.stringify(o)),window.PalmSystem.PmLogString?e==levelDebug?window.PalmSystem.PmLogString(e,null,null,n):window.PalmSystem.PmLogString(e,t,o,n):console.error("Unable to send log; PmLogString not found in this version of PalmSystem"))};webOS.emergency=function(e,t,o){log(levelEmergency,e,t,o)},webOS.alert=function(e,t,o){log(levelAlert,e,t,o)},webOS.critical=function(e,t,o){log(levelCritical,e,t,o)},webOS.error=function(e,t,o){log(levelError,e,t,o)},webOS.warning=function(e,t,o){log(levelWarning,e,t,o)},webOS.notice=function(e,t,o){log(levelNotice,e,t,o)},webOS.info=function(e,t,o){log(levelInfo,e,t,o)},webOS.debug=function(e){log(levelDebug,"","",e)},LS2Request.prototype.send=function(){if(!window.PalmServiceBridge)return void console.error("PalmServiceBridge not found.");this.bridge=new PalmServiceBridge;var e=this;this.bridge.onservicecallback=this.callback=function(t){var o;if(!e.cancelled){try{o=JSON.parse(t)}catch(n){o={errorCode:-1,errorText:t}}(o.errorCode||0==o.returnValue)&&e.onFailure?(e.onFailure(o),e.resubscribe&&e.subscribe&&(e.delayID=setTimeout(function(){e.send()},LS2Request.resubscribeDelay))):e.onSuccess&&e.onSuccess(o),e.onComplete&&e.onComplete(o),e.subscribe||e.cancel()}},this.bridge.call(this.uri,JSON.stringify(this.params))},LS2Request.prototype.cancel=function(){this.cancelled=!0,this.resubscribeJob&&clearTimeout(this.delayID),this.bridge&&(this.bridge.cancel(),this.bridge=void 0)},LS2Request.prototype.toString=function(){return"[LS2Request]"},LS2Request.resubscribeDelay=1e4,webOS.service={request:function(e,t){return new LS2Request(e,t)},systemPrefix:webOS.platform.legacy||webOS.platform.open?"com.palm.":"com.webos.",protocol:webOS.platform.legacy&&webOS.device.platformVersionMajor&&parseInt(webOS.device.platformVersionMajor)<=1?"palm://":"luna://"},navigator.service={request:webOS.service.request},navigator.service.Request=navigator.service.request,webOS.libVersion="0.1.0",webOS.voicereadout={readAlert:function(e){if(webOS&&webOS.platform&&webOS.platform.watch){var t=function(){webOS.service.request("luna://com.webos.settingsservice",{method:"getSystemSettings",parameters:{category:"VoiceReadOut"},onSuccess:function(e){e&&e.settings.talkbackEnable&&o()},onFailure:function(e){console.error("Failed to get system VoiceReadOut settings: "+JSON.stringify(e))}})},o=function(){webOS.service.request("luna://com.webos.settingsservice",{method:"getSystemSettings",parameters:{keys:["localeInfo"]},onSuccess:function(e){n(e)},onFailure:function(e){console.error("Failed to get system localeInfo settings: "+JSON.stringify(e))}})},n=function(t){var o;t&&t.settings.localeInfo&&(o=t.settings.localeInfo.locales.TTS,webOS.service.request("luna://com.lge.service.tts",{method:"speak",parameters:{locale:o,text:e}}))};t()}}},webOS.window={launchParams:function(e){return e=e||window,e.PalmSystem?JSON.parse(e.PalmSystem.launchParams||"{}")||{}:{}},isActivated:function(e){return e=e||window,e.PalmSystem?e.PalmSystem.isActivated:!1},activate:function(e){e=e||window,e.PalmSystem&&e.PalmSystem.activate()},deactivate:function(e){e=e||window,e.PalmSystem&&e.PalmSystem.deactivate()},newCard:function(e,t){e||webOS.platform.legacy||webOS.platform.open||(e="about:blank");var o=window.open(e);return t&&o.document.write(t),o.PalmSystem&&o.PalmSystem.stageReady(),o},setFullScreen:function(e){window.PalmSystem&&PalmSystem.enableFullScreenMode&&PalmSystem.enableFullScreenMode(e)},setWindowProperties:function(e,t){1==arguments.length&&(t=e,e=window),e.PalmSystem&&e.PalmSystem.setWindowProperties&&(e.webOS.window.properties=t=t||{},e.PalmSystem.setWindowProperties(t))},getWindowProperties:function(e){return e=e||window,e.webOS.window.properties=e.webOS.window.properties||{},e.webOS.window.properties},blockScreenTimeout:function(e){webOS.window.properties.blockScreenTimeout=e,this.setWindowProperties(navigator.windowProperties)},setSubtleLightbar:function(e){webOS.window.properties.setSubtleLightbar=e,this.setWindowProperties(webOS.window.properties)},setFastAccelerometer:function(e){webOS.window.properties.fastAccelerometer=e,this.setWindowProperties(webOS.window.properties)}};